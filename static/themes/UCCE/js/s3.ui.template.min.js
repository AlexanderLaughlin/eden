var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var u=0;return function(){return u<a.length?{done:!1,value:a[u++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,u,p){a!=Array.prototype&&a!=Object.prototype&&(a[u]=p.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,u){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:u})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(p){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(p||"")+"_"+u++,p)}var u=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,u){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var p=0,q={next:function(){if(p<a.length){var y=p++;return{value:u(y,a[y]),done:!1}}q.next=function(){return{done:!0,value:void 0}};return q.next()}};q[Symbol.iterator]=function(){return q};return q};
$jscomp.polyfill=function(a,u,p,q){if(u){p=$jscomp.global;a=a.split(".");for(q=0;q<a.length-1;q++){var y=a[q];y in p||(p[y]={});p=p[y]}a=a[a.length-1];q=p[a];u=u(q);u!=q&&null!=u&&$jscomp.defineProperty(p,a,{configurable:!0,writable:!0,value:u})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.findInternal=function(a,u,p){a instanceof String&&(a=String(a));for(var q=a.length,y=0;y<q;y++){var B=a[y];if(u.call(p,B,y,a))return{i:y,v:B}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,p){return $jscomp.findInternal(this,a,p).v}},"es6","es3");
(function(a){a(window.jQuery,window.loadImage)})(function(a,u){var p=0,q=[],y={1:["Strongly Disagree","Disagree","Undecided","Agree","Strongly Agree"],2:["Very unsatisfied","Unsatisfied","Neutral","Satisfied","Very satisfied"],3:["Very dissatisfied","Dissatisfied","Neutral","Satisfied","Very satisfied"],4:["Pain","Neutral","No Pain"]},B={},E={},F={},Q={text:1,number:2,multichoice:6,likert:12,heatmap:13},L={1:"text",2:"number",6:"multichoice",12:"likert",13:"heatmap"};a.widget("s3.surveyLayout",{options:{},
_create:function(){this.id=p;p+=1;this.eventNamespace=".surveyEditor"},_init:function(){var d=a(this.element),e=d.attr("id");e||(e="surveyEditor-widget-"+this.id);this.fieldname=e;this.recordID=d.data("id");this.data=null;this.ajaxMethod=void 0!==a.searchS3?a.searchS3:a.ajaxS3;a.validator.addMethod("lessThanMax",function(d,b){var c=b.id.split("-")[1];c=a("#max-"+c).val();return""==c?this.optional(b)||!0:this.optional(b)||parseFloat(d)<=c},"needs to be lower than Maximum");a.validator.addMethod("greaterThanMin",
function(d,b){var c=b.id.split("-")[1];c=a("#min-"+c).val();return""==c?this.optional(b)||!0:this.optional(b)||parseFloat(d)>=c},"needs to be higher than Minimum");this.refresh()},addQuestion:function(a,e,h,b){if("instructions"==h)b?this._addQuestion(a,e,h,null,!0):this._addQuestion(a,e,h);else if(b)this._addQuestion(a,e,h,b,!0);else{var c=this;b=S3.Ap.concat("/dc/question/create_json.json");var d=JSON.stringify({type:Q[h],template_id:this.recordID});this.ajaxMethod({url:b,type:"POST",data:d,dataType:"json",
success:function(b){c._addQuestion(a,e,h,b.question_id)},error:function(a,b,c){console.log("UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText)}})}},_addQuestion:function(d,e,h,b,c){var k=this.data.l10n;if(c)for(var l=1,g=Object.keys(F).length;l<=g;l++){if(d==F[l]){var f=l;break}}else"instructions"==h?this.data.layout[d]={type:"instructions",do:{text:""},say:{text:""}}:(f=Object.keys(F).length+1,F[f]=d,this.data.layout[d]={type:"question",id:b},this.data.questions[b]={type:Q[h],settings:{},options:[]}),
this.saveLayout();var n="",m;k||(n=" hide");var A='<li class="tab-title l10n'+n+'"><a href="#translation-'+d+'">Translation</a></li>';if("instructions"==h){var r="instruction-"+d;var p="";var R="#instruction-"+d+" input, #instruction-"+d+" select";n="#instruction-"+d+" .ucce-delete"}else{r="question-"+b;p=' data-number="'+f+'"';R="#question-"+b+" input, #question-"+b+" select";n="#question-"+b+" .ucce-delete";var z="";var t=this.data.questions[b];c&&t.mandatory&&(z=" checked");z='<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="mandatory-'+
b+'" type="checkbox" '+z+' class="fleft"><label>Make question mandatory</label></div></div>';if("heatmap"!=h){var G=this.pipeOptionsHtml(b);G='<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>Add image</label><span id="preview-'+b+'" class="preview-empty fleft"></span><label for="image-'+b+'" class="button tiny fleft">Upload image</label><input id="image-'+b+'" name="file" type="file" accept="image/png, image/jpeg" class="show-for-sr"><label class="fleft">or pipe question image:</label><select id="pipe-'+
b+'" class="fleft">'+G+'</select><a id="image-delete-'+b+'">Delete</a></div></div>'}}p='<div class="thumbnail dl-item" id="'+r+'" data-page="'+e+'"'+p+'><div class="card-header"><ul class="tabs fleft" data-tab><li class="tab-title active"><a href="#edit-'+d+'">Edit</a></li><li class="tab-title"><a href="#logic-'+d+'">Display logic</a></li> '+A+'</ul><div class="edit-bar fright"><a><i class="ucce ucce-duplicate"> </i></a><a><i class="ucce ucce-delete"> </i></a><i class="ucce ucce-up"> </i><i class="ucce ucce-down"> </i></div></div><div class="tabs-content">';
r='<div class="media content" id="logic-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Only display question if...</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><select id="logic-select-'+d+'"></select></div></div><div class="row" id="logic-response-row-'+d+'"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-2"><label class="fleft">response is</label></div><div class="columns medium-10" id="logic-response-'+
d+'"></div></div></div></div></div>';switch(h){case "instructions":z=m=f=G="";if(c){var v=this.data.layout[d];G=v.do.text;m=v.say.text;k&&v.do.l10n&&(f=v.do.l10n[k],z=v.say.l10n[k])}v='<div class="media content active" id="edit-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Data collector instructions</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>What instructor should do</label><input id="do-'+
d+'" type="text" size=100 placeholder="Type what instructor should do" value="'+G+'"><label>What instructor should say</label><input id="say-'+d+'" type="text" size=100 placeholder="Type what instructor should say" value="'+m+'"></div></div></div>';m='<div class="media content" id="translation-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Data collector instructions</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>What instructor should do</label><div class="translate-from"></div><input id="do-l10n-'+
d+'" type="text" size=100 placeholder="Type translation..." value="'+f+'"><label>What instructor should say</label><div class="translate-from"></div><input id="say-l10n-'+d+'" type="text" size=100 placeholder="Type translation..." value="'+z+'"></div></div></div>';break;case "text":m=v="";c&&(v=t.name,k&&(m=t.name_l10n||""));v='<div class="media content active" id="edit-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Text box</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-'+
b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><input id="name-'+b+'" type="text" size=100 placeholder="type question" value="'+v+'"></div></div>'+z+G+"</div>";m='<div class="media content" id="translation-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Text box</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-l10n-'+b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><div id="name-l10n-from-'+
b+'" class="translate-from"></div></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="name-l10n-'+b+'" type="text" size=100 placeholder="type translated question" value="'+m+'"></div></div></div>';break;case "number":g=A=m=v="";c&&(v=t.name,k&&(m=t.name_l10n||""),l=t.settings||{},l=(l.requires||{}).isIntInRange)&&(A=l.min||"",g=l.max||"");v='<div class="media content active" id="edit-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Number question</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-'+
b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><input id="name-'+b+'"type="text" size=100 placeholder="type question" value="'+v+'"></div></div>'+z+G+'<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Answer</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>Restrict input to:</label></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><form id="answer-'+
b+'"><label class="fleft">Minimum:</label><input id="min-'+b+'" name="min" type="number" value="'+A+'" class="fleft"><label class="fleft">Maximum:</label><input id="max-'+b+'" name="max" type="number" value="'+g+'" class="fleft"></form></div></div></div>';m='<div class="media content" id="translation-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Number question</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-l10n-'+
b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><div id="name-l10n-from-'+b+'" class="translate-from"></div></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="name-l10n-'+b+'" type="text" size=100 placeholder="type translated question" value="'+m+'"></div></div></div>';break;case "multichoice":var M='<div id="choice-row-'+b+'-0" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input class="choice-'+
b+'" type="text" placeholder="Enter an answer choice"><i class="ucce ucce-minus"> </i><i class="ucce ucce-plus"> </i></div></div>';m=v="";g=M;var N=A="",S=" disabled",C="",I="";l=1;var T="";if(c){v=t.name;k&&(m=t.name_l10n||"");C=t.options||[];I=t.options_l10n||[];var H=C.length;if(H)for(g="",l=0;l<H;l++){g+='<div id="choice-row-'+b+"-"+l+'" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input class="choice-'+b+'" type="text" placeholder="Enter an answer choice" value="'+
C[l]+'"><i class="ucce ucce-minus"> </i><i class="ucce ucce-plus"> </i></div></div>';var K=I[l]||"";K='<div id="choice-l10n-row-'+b+"-"+l+'" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><div id="choice-from-'+b+"-"+l+'" class="translate-from">'+C[l]+'</div></div><div class="columns medium-6"><input class="choice-l10n-'+b+'" type="text" placeholder="Type translation..." value="'+K+'"></div></div></div></div>';A+=K}l=t.settings;
I="";H=" hide";if(C=l.other||"")N=" checked",S="",I=l.otherL10n||"",H="";A+='<div id="other-l10n-row-'+b+'" class="row'+H+'"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><div id="other-l10n-from-'+b+'" class="translate-from">'+C+'</div></div><div class="columns medium-6"><input id="other-l10n-'+b+'" type="text" placeholder="Type translation..." value="'+I+'"></div></div></div></div>';l=l.multiple||1;1<l&&(T=" checked")}v='<div class="media content active" id="edit-'+
d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Multiple choice question</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-'+b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><input id="name-'+b+'"type="text" size=100 placeholder="type question" value="'+v+'"></div></div>'+z+G+'<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Answer</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>Choices</label></div></div>'+
g+'<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="other-'+b+'" type="checkbox"'+N+'><label>Add \'other field\'</label></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label class="fleft">Field label</label><input id="other-label-'+b+'" type="text" placeholder="Other (please specify)" value="'+C+'"'+S+'></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="multiple-'+
b+'" type="checkbox"'+T+'><label>Allow multiple responses</label></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label class="fleft">Maximum No. of responses:</label><i class="ucce ucce-minus"> </i> <span id="multiple-count-'+b+'">'+l+'</span> <i class="ucce ucce-plus"> </i></div></div></div>';m='<div class="media content" id="translation-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Multiple choice question</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-l10n-'+
b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><div id="name-l10n-from-'+b+'" class="translate-from"></div></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="name-l10n-'+b+'" type="text" size=100 placeholder="type translated question" value="'+m+'"></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Answer</h2></div></div><div class="row" id="choices-l10n-row-'+
b+'"><div class="columns medium-1"></div><div class="columns medium-11"><label>Choices</label></div></div>'+A+"</div>";break;case "likert":A=m=v="";N=['<option value="1">Agreement (Disagree - Agree)</option>','<option value="2">Satisfaction (Smiley scale)</option>','<option value="3">Satisfaction (Dissatisfied - Satisfied)</option>','<option value="4">Pain scale (3 point)</option>'];if(c&&(v=t.name,k&&(m=t.name_l10n||""),(l=t.settings)&&l.hasOwnProperty("scale")&&(g=l.scale))){N[g-1]=N[g-1].replace('">',
'" selected>');C=y[g];A+="<ul>";l=0;for(g=C.length;l<g;l++)A+="<li>"+C[l]+"</li>";A+="</ul>"}g=N.join();v='<div class="media content active" id="edit-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Likert-scale</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-'+b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><input id="name-'+b+'"type="text" size=100 placeholder="type question" value="'+
v+'"></div></div>'+z+G+'<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Answer</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label>Choices</label><select id="scale-'+b+'"><option value="">Please choose scale</option>'+g+'</select></div></div><div class="row"><div class="columns medium-1"></div><div id="display-'+b+'" class="columns medium-11">'+A+"</div></div></div>";m='<div class="media content" id="translation-'+
d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Likert-scale</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-l10n-'+b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><div id="name-l10n-from-'+b+'" class="translate-from"></div></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="name-l10n-'+b+'" type="text" size=100 placeholder="type translated question" value="'+
m+'"></div></div></div>';break;case "heatmap":M='<div id="choice-row-'+b+'-0" class="row"><a class="button tiny secondary choice-define-'+b+'">Add region 1</a><input class="choice-'+b+'" type="text" placeholder="enter label" disabled><i class="ucce ucce-minus"> </i></div>';m=v="";G=1;g=M;I=A="";if(c){v=t.name;k&&(m=t.name_l10n||"");C=t.options||[];I=t.options_l10n||[];if(H=C.length){g="";for(l=0;l<H;l++)g+='<div id="choice-row-'+b+"-"+l+'" class="row"><a class="button tiny">Add region '+(l+1)+'</a><input class="choice-'+
b+'" type="text" placeholder="enter label" value="'+C[l]+'"><i class="ucce ucce-minus"> </i></div>',K=I[l]||"",K='<div id="choice-l10n-row-'+b+"-"+l+'" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><div id="choice-from-'+b+"-"+l+'" class="translate-from">'+C[l]+'</div></div><div class="columns medium-6"><input class="choice-l10n-'+b+'" type="text" placeholder="Type translation..." value="'+K+'"></div></div></div></div>',
A+=K;g+=M.replace("-0","-"+H).replace("region 1","region "+(H+1))}G=t.settings.numClicks||1}v='<div class="media content active" id="edit-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Heatmap</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-'+b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><input id="name-'+b+'"type="text" size=100 placeholder="type question" value="'+v+'"></div></div>'+
z+'<div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Image</h2></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><label for="image-'+b+'" class="button tiny fleft">Upload image</label><input id="image-'+b+'" name="file" type="file" accept="image/png, image/jpeg" class="show-for-sr"></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><span id="preview-'+
b+'" class="preview-empty fleft"></span></div><div class="columns medium-6"><div class="row"><h3>Number of clicks allowed:</h3></div><div class="row" id="clicks-row-'+b+'"><i class="ucce ucce-minus"> </i><span> '+G+' </span><i class="ucce ucce-plus"> </i></div><div class="row"><h3>Tap/click regions:</h3></div>'+g+"</div></div></div></div></div>";m='<div class="media content" id="translation-'+d+'"><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="left">Heatmap</h2></div></div><div class="row"><div class="columns medium-1"><label id="qlabel-l10n-'+
b+'" class="fright">Q'+f+'</label></div><div class="columns medium-11"><div id="name-l10n-from-'+b+'" class="translate-from"></div></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><input id="name-l10n-'+b+'" type="text" size=100 placeholder="type translated question" value="'+m+'"></div></div><div class="row"><div class="columns medium-1"></div><div class="columns medium-11"><h2 class="fleft">Answer</h2></div></div><div class="row" id="choices-l10n-row-'+
b+'"><div class="columns medium-1"></div><div class="columns medium-11"><label>Regions</label></div></div>'+A+"</div>"}p=p+v+r+m;p+="</div></div>";a("#survey-droppable-"+d).before(p);f=d+1;a("#survey-droppable-"+d).attr("id","survey-droppable-"+f);E[e]++;a("#section-break-"+B[e]+" > span").html("PAGE "+e+" ("+E[e]+" ELEMENTS)");var w=this.eventNamespace,x=this,P=function(){a(R).off("change"+w).on("change"+w,function(){var c=this.id.split("-");if("logic"==c[0])c=parseInt(c[c.length-1]),x.logicSelected(a(this),
c);else if("instructions"==h){c=parseInt(c[c.length-1]);var d=x.data.layout[c];d.do.text=a("#do-"+c).val();d.say.text=a("#say-"+c).val();k&&(d.do.hasOwnProperty("10n")||(d.do.l10n={}),d.do.l10n[k]=a("#do-l10n-"+c).val(),d.say.hasOwnProperty("10n")||(d.say.l10n={}),d.say.l10n[k]=a("#say-l10n-"+c).val());x.saveLayout()}else x.saveQuestion(h,b)});if("instructions"!=h&&"heatmap"!=h)a("#pipe-"+b).on("change"+w,function(){var c=a(this).val();if(c){for(var d,e=0,f=q.length;e<f;e++)if(d=q[e],d.label==c){t.settings.pipeImage=
{id:d.id,region:d.region};break}x.deleteImage(b)}else delete t.settings.pipeImage;x.saveQuestion(h,b)})};P();"instructions"!=h&&(c&&(e=t.file)&&u(S3.Ap.concat("/default/download/"+e),function(c){var d=u.scale(c,{canvas:!0,maxHeight:80,maxWidth:80});a("#preview-"+b).removeClass("preview-empty").empty().append(d);return c},{}),a("#image-delete-"+b).on("click"+w,function(){x.deleteImage(b)}),a("#image-"+b).fileupload({dataType:"json",dropZone:a("#preview-"+b+", #image-"+b),maxNumberOfFiles:1,url:S3.Ap.concat("/dc/question/")+
b+"/image_upload.json",add:function(c,d){if(c.isDefaultPrevented())return!1;(d.autoUpload||!1!==d.autoUpload&&a(this).fileupload("option","autoUpload"))&&d.process().done(function(){d.submit();u(d.files[0],function(c){var d=u.scale(c,{canvas:!0,maxHeight:80,maxWidth:80});a("#preview-"+b).removeClass("preview-empty").empty().append(d);d=t.type;if(13!=d){t.settings.hasOwnProperty("pipeImage")&&a("#pipe-"+b).val("").trigger("change");var e=!1;for(c in q)c.id==b&&(e=!0);e||(d="Q"+a("#question-"+b).data("number")+
" "+L[d],q.push({label:d,id:b}));d=x.data.questions;e=x.data.layout;for(var f=1;f<=Object.keys(e).length;f++){var g=e[f];if("question"==g.type){g=g.id;var k=d[g];13!=k.type&&a("#pipe-"+g).empty().append(x.pipeOptionsHtml(g))}}}return c},{})})}}));a(n).on("click"+w,function(){x.deleteQuestion(h,b,this)});switch(h){case "number":a("#answer-"+b).validate({rules:{min:{required:!1,digits:!0,lessThanMax:!0},max:{required:!1,digits:!0,greaterThanMin:!0}},messages:{min:{digits:"Only integers allowed"},max:{digits:"Only integers allowed"}},
errorClass:"req",focusCleanup:!0});break;case "multichoice":var J=a("#multiple-"+b),D=a("#multiple-count-"+b),O=function(){var c=a(".choice-"+b).next();c.off("click"+w).on("click"+w,function(){if(1<a(".choice-"+b).length){var c=a(this).closest(".row"),d=parseInt(c.attr("id").split("-")[3]);c.remove();a("#choice-l10n-row-"+b+"-"+d).remove();c=a(".choice-"+b).length;for(var e=d+1;e<=c;e++)d=e-1,a("#choice-row-"+b+"-"+e).attr("id","choice-row-"+b+"-"+d),a("#choice-l10n-row-"+b+"-"+e).attr("id","choice-l10n-row-"+
b+"-"+d),a("#choice-from-"+b+"-"+e).attr("id","choice-from-"+b+"-"+d);d=parseInt(D.html());a("#other-"+b).prop("checked")&&c++;d>c&&(D.html(c),1==c&&J.prop("checked",!1));x.saveQuestion(h,b)}else a(this).prev().val("")});c.next().off("click"+w).on("click"+w,function(){for(var c=a(this).closest(".row"),d=parseInt(c.attr("id").split("-")[3]),e,f=a(".choice-"+b).length-1;f>d;f--)e=f+1,a("#choice-row-"+b+"-"+f).attr("id","choice-row-"+b+"-"+e),a("#choice-l10n-row-"+b+"-"+f).attr("id","choice-l10n-row-"+
b+"-"+e),a("#choice-from-"+b+"-"+f).attr("id","choice-from-"+b+"-"+e);e=d+1;c.after(M.replace("-0","-"+e));c='<div id="choice-l10n-row-'+b+"-"+e+'" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><div id="choice-from-'+b+"-"+e+'" class="translate-from"></div></div><div class="columns medium-6"><input class="choice-l10n-'+b+'" type="text" placeholder="Type translation..."></div></div></div></div>';a("#choice-l10n-row-"+b+
"-"+d).after(c);P();O()});a("#other-"+b).on("change"+w,function(){if(a(this).prop("checked"))a("#other-label-"+b).prop("disabled",!1),a("#other-l10n-row-"+b).removeClass("hide").show();else{a("#other-label-"+b).prop("disabled",!0);a("#other-l10n-row-"+b).hide();var c=parseInt(D.html()),d=a(".choice-"+b).length;c>d&&(D.html(d),1==d&&J.prop("checked",!1))}});J.on("change"+w,function(){if(J.prop("checked")){parseInt(D.html());var c=a(".choice-"+b).length;a("#other-"+b).prop("checked")&&c++;1<c?D.html(2):
J.prop("checked",!1)}else D.html(1);x.saveQuestion(h,b)});D.prev().on("click"+w,function(){if(J.prop("checked")){var a=parseInt(D.html());2<a?(D.html(a-1),x.saveQuestion(h,b)):2==a&&(D.html(1),J.prop("checked",!1),x.saveQuestion(h,b))}});D.next().on("click"+w,function(){if(J.prop("checked")){var c=parseInt(D.html()),d=a(".choice-"+b).length;a("#other-"+b).prop("checked")&&d++;c<d&&(D.html(c+1),x.saveQuestion(h,b))}})};O();break;case "likert":a("#scale-"+b).on("change"+w,function(){var c=a(this).val();
if(c){c=y[c];for(var d="",e=0,f=c.length;e<f;e++)d+="<li>"+c[e]+"</li>";c="<ul>"+d+"</ul>";a("#display-"+b).empty().append(c)}else a("#display-"+b).empty()});break;case "heatmap":O=function(){a(".choice-"+b).next().off("click"+w).on("click"+w,function(){if(1<a(".choice-"+b).length){var c=a(this).closest(".row"),d=parseInt(c.attr("id").split("-")[3]);c.remove();a("#choice-l10n-row-"+b+"-"+d).remove();c=a(".choice-"+b).length;for(var e=d+1;e<=c;e++)d=e-1,a("#choice-row-"+b+"-"+e).attr("id","choice-row-"+
b+"-"+d),a("#choice-row-"+b+"-"+d+" > .button").html("Add region "+(d+1)),a("#choice-l10n-row-"+b+"-"+e).attr("id","choice-l10n-row-"+b+"-"+d),a("#choice-from-"+b+"-"+e).attr("id","choice-from-"+b+"-"+d);x.saveQuestion(h,b)}else c=a(this).prev(),c.val("").prop("disabled",!0),c.prev().addClass("secondary")});a(".choice-define-"+b).off("click"+w).on("click"+w,function(){var c=a(this),d=c.closest(".row"),e=parseInt(d.attr("id").split("-")[3]);if(c.hasClass("secondary")){var f=e+1;d.after(M.replace("-0",
"-"+f));a("#choice-row-"+b+"-"+f+" > .button").html("Add region "+(f+1));d='<div id="choice-l10n-row-'+b+"-"+e+'" class="row"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-6"><div id="choice-from-'+b+"-"+e+'" class="translate-from"></div></div><div class="columns medium-6"><input class="choice-l10n-'+b+'" type="text" placeholder="Type translation..."></div></div></div></div>';0==e?a("#choices-l10n-row-"+b).after(d):a("#choice-l10n-row-"+
b+"-"+(e-1)).after(d);P();O()}c.removeClass("secondary");c.next().prop("disabled",!1)})},O(),e=a("#clicks-row-"+b).children().first(),e.off("click"+w).on("click"+w,function(){var c=a(this),d=parseInt(c.next().html());1<d&&(d--,x.data.questions[b].settings.numClicks=d,x.saveQuestion(h,b),c.next().html(" "+d+" "))}),e.next().next().off("click"+w).on("click"+w,function(){var c=a(this).prev(),d=parseInt(c.html());d++;x.data.questions[b].settings.numClicks=d;x.saveQuestion(h,b);c.html(" "+d+" ")})}"instructions"==
h?a("#instruction-"+d).foundation("tab","reflow"):a("#question-"+b).foundation("tab","reflow")},deleteQuestion:function(d,e,h){if("instructions"==d){h=parseInt(a(h).closest(".dl-item").attr("id").split("-")[1]);var b=a("#instruction-"+h).data("page")}else{var c=a("#question-"+e).data("number");h=F[c];b=a("#question-"+e).data("page")}E[b]--;a("#section-break-"+B[b]+" > span").html("PAGE "+b+" ("+E[b]+" ELEMENTS)");var k=b+1;for(b=Object.keys(B).length;k<=b;k++)B[k]--;b=c;var l,g,f=this.data.layout,
n=Object.keys(f).length;for(k=h;k<n;k++){c=k+1;var m=f[c];f[k]=m;if("break"==m.type)a("#section-break-"+c).attr("id","section-break-"+k);else{if("question"==m.type){var p=m.id;m=a("#question-"+p);b=m.data("number");if("instructions"==d)F[b]=k;else{var r=b-1;m.data("number",r);a("#qlabel-"+p).html("Q"+r);a("#qlabel-l10n-"+p).html("Q"+r);F[r]=k}}else a("#instruction-"+c).attr("id","instruction-"+k),m=a("#instruction-"+k),a("#do-"+c).attr("id","do-"+k),a("#say-"+c).attr("id","say-"+k),a("#do-l10n-"+
c).attr("id","do-l10n-"+k),a("#say-l10n-"+c).attr("id","say-l10n-"+k);a("#edit-"+c).attr("id","edit-"+k);a("#logic-"+c).attr("id","logic-"+k);a("#translation-"+c).attr("id","translation-"+k);m.find("li.tab-title > a").each(function(){var b=a(this);l=b.attr("href");g=l.split("-")[0];g=g.substring(1,g.length);b.attr("href","#"+g+"-"+k)})}}delete f[n];"instructions"!=d&&delete F[b];this.saveLayout();"instructions"==d?a("#instruction-"+h).remove():a("#question-"+e).remove();a("#survey-droppable-"+(n+
1)).attr("id","survey-droppable-"+n);"instructions"!=d&&(d=S3.Ap.concat("/dc/question/")+e+"/delete.json",this.ajaxMethod({url:d,type:"POST",dataType:"json",success:function(){},error:function(a,b,c){console.log("UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText)}}))},pipeOptionsHtml:function(a){var d=this.data.questions[a];var h='<option value="">select question</option>';if(d&&d.settings&&d.settings.pipeImage)var b=d.settings.pipeImage;for(var c=0,k=q.length;c<k;c++)d=q[c],d.id!=a&&(h=b&&
b.id==d.id&&b.region==d.region?h+("<option selected>"+d.label+"</option>"):h+("<option>"+d.label+"</option>"));return h},logicOptionsHtml:function(a,e){var d='<option value="">select question</option>',b=this.data.questions,c=this.data.layout;e=c[e].displayLogic;if(e)var k=e.id;e=1;for(var l=Object.keys(F).length;e<=l;e++){var g=F[e];g=c[g].id;if(g!=a){var f=b[g];var n=L[f.type];if("number"==n||"multichoice"==n||"likert"==n||"heatmap"==n)n="Q"+e+": ",f=f.name||"",f=53<f.length?f.substring(0,50)+"...":
f,n+=f,f=g==k?" selected":"",d+='<option value="'+g+'"'+f+">"+n+"</option>"}}return d},logicSubOptions:function(d,e){var h=this.eventNamespace,b=this,c=this.data.layout[d].displayLogic,k=this.data.questions[e],l=L[k.type];if("number"==l){var g="",f="";if(c){g=c.eq||"";var n=c.gt;var m=c.lt;g?f=g:m?f=m:n&&(f=n)}k='<select id="logic-operator-1-'+d+'">';k=!c||g?k+'<option value="eq" selected>equal to ( = )</option>':k+'<option value="eq">equal to ( = )</option>';m?k+='<option value="lt" selected>less than ( &lt; )</option><option value="gt">more than ( &gt; )</option>':
(k+='<option value="lt">less than ( &lt; )</option>',k=n?k+'<option value="gt" selected>more than ( &gt; )</option>':k+'<option value="gt">more than ( &gt; )</option>');k+='</select><input id="logic-term-1-'+d+'" type="number" placeholder="type number" value="'+f+'">';a("#logic-response-"+d).html(k);g||!m&&!n?(f="",g=" hide"):(g="",f=m&&n?n:"");g='<div class="row'+g+'"><div class="columns medium-1"></div><div class="columns medium-11"><div class="row"><div class="columns medium-2"><label class="fleft">AND</label></div><div class="columns medium-10"><select id="logic-operator-2-'+
d+'">'+(!m&&n?'<option value="lt" selected>less than ( &lt; )</option><option value="gt">more than ( &gt; )</option>':'<option value="lt">less than ( &lt; )</option><option value="gt" selected>more than ( &gt; )</option>')+'</select><input id="logic-term-2-'+d+'" type="number" placeholder="type number" value="'+f+'"></div></div></div></div>';var p=a("#logic-response-row-"+d);p.after(g);var r,q=a("#logic-operator-1-"+d),u=a("#logic-operator-2-"+d),z=a("#logic-term-1-"+d),t=a("#logic-term-2-"+d);q.on("change"+
h,function(){r=a(this).val();f=z.val();c={id:e};if("eq"==r)p.next().hide(),f&&(c.eq=f);else if("gt"==r){if(p.next().removeClass("hide").show(),u.val("lt"),f&&(c.gt=f),f=t.val())c.lt=f}else"lt"==r&&(p.next().removeClass("hide").show(),u.val("gt"),f&&(c.lt=f),f=t.val())&&(c.gt=f);b.data.layout[d].displayLogic=c;b.saveLayout()});u.on("change"+h,function(){r=a(this).val();f=t.val();c={id:e};if("gt"==r){if(q.val("lt"),f&&(c.gt=f),f=z.val())c.lt=f}else"lt"==r&&(q.val("gt"),f&&(c.lt=f),f=z.val())&&(c.gt=
f);b.data.layout[d].displayLogic=c;b.saveLayout()});z.on("change"+h,function(){if(f=a(this).val()){c={id:e};r=q.val();if("eq"==r)c.eq=f;else if("gt"==r?c.gt=f:c.lt=f,f=t.val())r=u.val(),"gt"==r?c.gt=f:c.lt=f;b.data.layout[d].displayLogic=c}else(f=t.val())?(c={id:e},r=q.val(),"gt"==r?c.gt=f:c.lt=f,b.data.layout[d].displayLogic=c):delete b.data.layout[d].displayLogic;b.saveLayout()});t.on("change"+h,function(){if(f=a(this).val()){c={id:e};r=u.val();"gt"==r?c.gt=f:c.lt=f;if(f=z.val())r=q.val(),"gt"==
r?c.gt=f:c.lt=f;b.data.layout[d].displayLogic=c}else(f=z.val())?(c={id:e},r=q.val(),"eq"==r?c.eq=f:"gt"==r?c.gt=f:c.lt=f,b.data.layout[d].displayLogic=c):delete b.data.layout[d].displayLogic;b.saveLayout()})}else{m=k.options;n='<select id="sub-logic-select-'+d+'"><option value="">select '+("heatmap"==l?"region":"option")+"</option>";c&&(g=c.option);for(var y=0,v=m.length;y<v;y++){option=m[y];var B=option==g?" selected":"";n+='<option value="'+option+'"'+B+">"+option+"</option>"}"multichoice"==l&&
(k=k.settings.other)&&(n+='<option value="_other"'+("_other"==g?" selected":"")+">"+k+"</option>");n+="</select>";a("#logic-response-"+d).html(n);a("#sub-logic-select-"+d).on("change"+h,function(){b.data.layout[d].displayLogic={id:e,option:a(this).val()};b.saveLayout()})}},logicSelected:function(d,e){d=d.val();a("#logic-response-"+e).empty();a("#logic-response-row-"+e).next().remove();d?this.logicSubOptions(e,d):(delete this.data.layout[e].displayLogic,this.saveLayout())},deleteImage:function(d){var e=
this,h=a("#preview-"+d);if(!h.hasClass("preview-empty")){var b=S3.Ap.concat("/dc/question/")+d+"/image_delete.json";this.ajaxMethod({url:b,type:"POST",dataType:"json",success:function(){h.empty().addClass("preview-empty");var b=q;q=[];for(var k=0,l=b.length;k<l;k++){var g=b[k];g.id!=d&&q.push(g)}g=e.data.questions;b=e.data.layout;for(k=1;k<=Object.keys(b).length;k++)if(l=b[k],"question"==l.type){l=l.id;var f=g[l];13!=f.type&&a("#pipe-"+l).empty().append(e.pipeOptionsHtml(l))}},error:function(a,b,
d){console.log("UNAUTHORIZED"==d?i18n.gis_requires_login:a.responseText)}})}},addSectionBreak:function(d,e,h){e++;B[e]=d;E[e]=0;var b='<div class="row"><div class="section-break medium-11 columns" id="section-break-'+d+'" data-page="'+e+'"><span>PAGE '+e+' (0 ELEMENTS)</span></div><div class="medium-1 columns">'+(d?'<i class="ucce ucce-delete-page"> </i>':"")+'<i class="ucce ucce-down-alt"> </i></div></div>';if(d){a("#survey-droppable-"+d).before(b);b=d+1;a("#survey-droppable-"+d).data("page",e).attr("id",
"survey-droppable-"+b);h||(this.data.layout[d]={type:"break"},this.saveLayout());var c=this;e=this.eventNamespace;a("#section-break-"+d).next().children(".ucce-delete-page").on("click"+e,function(){var b=parseInt(a(this).parent().prev().attr("id").split("-")[2]);c.deleteSectionBreak(b)})}else a(this.element).parent().append(b)},deleteSectionBreak:function(d){var e=a("#section-break-"+d).data("page"),h=E[e];if(h){var b=e-1;E[b]+=h;a("#section-break-"+B[b]+" > span").html("PAGE "+b+" ("+E[b]+" ELEMENTS)")}h=
Object.keys(B).length;for(var c=e;c<h;c++)B[c]=B[c+1]-1,E[c]=E[c+1];delete B[h];delete E[h];e=this.data.layout;b=Object.keys(e).length;if(d!=b){var k,l;for(c=d;c<b;c++){var g=c+1;var f=e[g];e[c]=f;if("break"==f.type)f=a("#section-break-"+g).data("page")-1,a("#section-break-"+g).data("page",f),a("#section-break-"+g+" > span").html("PAGE "+f+" ("+E[f]+" ELEMENTS)"),a("#section-break-"+g).attr("id","section-break-"+c);else{if("question"==f.type){var n=a("#question-"+f.id);f=n.data("number");F[f]=c}else a("#instruction-"+
g).attr("id","instruction-"+c),n=a("#instruction-"+c),a("#do-"+g).attr("id","do-"+c),a("#say-"+g).attr("id","say-"+c),a("#do-l10n-"+g).attr("id","do-"+c),a("#say-l10n-"+g).attr("id","say-"+c);a("#edit-"+g).attr("id","edit-"+c);a("#logic-"+g).attr("id","logic-"+c);a("#translation-"+g).attr("id","translation-"+c);n.find("li.tab-title > a").each(function(){var b=a(this);k=b.attr("href");l=k.split("-")[0];l=l.substring(1,l.length);b.attr("href","#"+l+"-"+c)})}}}delete e[b];this.saveLayout();a("#section-break-"+
d).parent().remove();a("#survey-droppable-"+(b+1)).data("page",h-1).attr("id","survey-droppable-"+b)},droppable:function(d,e){var h=this;e='<div class="survey-droppable" id="survey-droppable-'+d+'" data-page="'+e+'"><span>Drag and drop questions here</span></div>';a(this.element).parent().append(e);a("#survey-droppable-"+d).droppable({drop:function(b,c){b=c.draggable[0].id;c=parseInt(this.id.split("-")[2]);var d=a(this).data("page");"break"==b?h.addSectionBreak(c,d):h.addQuestion(c,d,b)}})},_destroy:function(){a.Widget.prototype.destroy.call(this)},
loadSurvey:function(){var a=this.data.layout;if(a){for(var e,h=1,b=0,c,k,l=this.data.questions,g=Object.keys(a).length,f=1;f<=g;f++)if(e=a[f],"break"!=e.type&&"instructions"!=e.type&&(b++,F[b]=f,e=e.id,c=l[e],c.file))if(13==c.type){var n=c.settings.regions;if(n){c="Q"+b+" Heatmap; ";for(var m=0,p=n.length;m<p;m++)k=c+"'"+n[m].label+"'",q.push({label:k,id:e,region:m})}}else k="Q"+b+" "+L[c.type],q.push({label:k,id:e});for(f=1;f<=g;f++)e=a[f],"break"==e.type?(this.addSectionBreak(f,h,!0),h++):"instructions"==
e.type?this.addQuestion(f,h,"instructions",!0):(e=e.id,this.addQuestion(f,h,L[l[e].type],e))}},refresh:function(){this._unbindEvents();this._deserialize();this.addSectionBreak(0,0);this.droppable(1,1);this.loadSurvey();this._bindEvents()},saveQuestion:function(d,e){var h=a("#name-"+e).val();if(h){var b=S3.Ap.concat("/dc/question/")+e+"/update_json.json",c=a("#mandatory-"+e).prop("checked"),k={name:h,mandatory:c},l=this.data.l10n,g={},f=this.data.questions[e];f.name=h;f.mandatory=c;l&&(h=a("#name-l10n-"+
e).val())&&(k.name_l10n=h,f.name_l10n=h);if(h=f.settings.pipeImage)g.pipeImage=h;switch(d){case "number":a("#min-"+e).hasClass("req")?d=null:(d=a("#min-"+e).val())&&(d=parseInt(d));a("#max-"+e).hasClass("req")?e=null:(e=a("#max-"+e).val())&&(e=parseInt(e));g.requires={isIntInRange:{min:d,max:e}};break;case "multichoice":var n=[];a(".choice-"+e).each(function(){n.push(a(this).val())});k.options=n;f.options=n;if(l){var m=[];a(".choice-l10n-"+e).each(function(){m.push(a(this).val())});k.options_l10n=
m}a("#other-"+e).prop("checked")?(g.other=a("#other-label-"+e).val(),l&&(g.otherL10n=a("#other-l10n-"+e).val())):(g.other=null,l&&(g.otherL10n=null));a("#multiple-"+e).prop("checked")?g.multiple=parseInt(a("#multiple-count-"+e).html()):g.multiple=1;break;case "likert":(e=a("#scale-"+e).val())?(n=y[e],g.scale=e):(n=[],g.scale=null);k.options=n;f.options=n;break;case "heatmap":if(n=[],a(".choice-"+e).each(function(){n.push(a(this).val())}),n.pop(),k.options=n,f.options=n,l&&(m=[],a(".choice-l10n-"+
e).each(function(){m.push(a(this).val())}),k.options_l10n=m),e=f.settings.numClicks)g.numClicks=e}k.settings=g;f.settings=g;this.ajaxMethod({url:b,type:"POST",data:JSON.stringify(k),dataType:"json",success:function(){},error:function(a,b,c){console.log("UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText)}})}},saveLayout:function(){var a=S3.Ap.concat("/dc/template/")+this.recordID+"/update_json.json";this.ajaxMethod({url:a,type:"POST",data:JSON.stringify({layout:this.data.layout}),dataType:"json",
success:function(){},error:function(a,d,b){console.log("UNAUTHORIZED"==b?i18n.gis_requires_login:a.responseText)}})},_deserialize:function(){var d=a(this.element).val()||"{}";return this.data=JSON.parse(d)},_bindEvents:function(){var d=this,e=this.eventNamespace,h=a("#survey-name");a(document).foundation({tab:{callback:function(b){var c=b.text();if("Display logic"==c){c=b.children().first().attr("href").split("-")[1];var e=a("#logic-select-"+c);b=b.closest(".dl-item").attr("id").split("-");var l=
b[0];if("instruction"==l)e.html(d.logicOptionsHtml(null,c));else{var g=b[1];e.html(d.logicOptionsHtml(g,c))}d.logicSelected(e,c)}else if("Translation"==c)if(c=b.children().first().attr("href").split("-")[1],b=b.closest(".dl-item").attr("id").split("-"),l=b[0],"instruction"==l)a("#do-l10n-"+c).prev().html(a("#do-"+c).val()),a("#say-l10n-"+c).prev().html(a("#say-"+c).val());else switch(g=b[1],c=d.data.questions[g],a("#name-l10n-from-"+g).html(a("#name-"+g).val()),l=L[c.type],l){case "multichoice":a(".choice-"+
g).each(function(b){a("#choice-from-"+g+"-"+b).html(a(this).val())});a("#other-l10n-from-"+g).html(a("#other-label-"+g).val());break;case "heatmap":a(".choice-"+g).each(function(b){a("#choice-from-"+g+"-"+b).html(a(this).val())})}}}});h.on("change"+e,function(){var a=h.val(),c=h.data("id");d.ajaxMethod({url:S3.Ap.concat("/dc/target/")+c+"/name.json",type:"POST",data:JSON.stringify({name:a}),dataType:"json",success:function(){},error:function(a,b,c){console.log("UNAUTHORIZED"==c?i18n.gis_requires_login:
a.responseText)}})});a("#survey-l10n").on("change"+e,function(){var b=a(this).val(),c=h.data("id");d.ajaxMethod({url:S3.Ap.concat("/dc/target/")+c+"/l10n.json",type:"POST",data:JSON.stringify({l10n:b}),dataType:"json",success:function(){(d.data.l10n=b)?(a("li.l10n").removeClass("hide").show(),a(document).foundation("tab","reflow")):a("li.l10n").hide()},error:function(a,b,c){console.log("UNAUTHORIZED"==c?i18n.gis_requires_login:a.responseText)}})});a(".draggable").draggable({revert:!0,revertDuration:250})},
_unbindEvents:function(){var d=this.eventNamespace;a("#survey-name").unbind(d);a("#survey-l10n").unbind(d);d=a(".draggable");void 0!=d.draggable("instance")&&d.draggable("destroy");return!0}})});
